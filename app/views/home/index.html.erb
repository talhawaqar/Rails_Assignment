<div>
  <canvas id="myChart"></canvas>
</div>
<br/>
<div class="container">
	<h2>Deals</h2>
  <table id="sites-table" class="table table-striped table-bordered" style="width: 1000px;">
		<thead>
			<th>Listing Id</th>
			<th>Listing Month</th>
			<th>Listing Date</th>
			<th>Broker</th>
      <th>Revenue</th>
		</thead>
		<tbody>
      <% @sites.each do |site| %>
        <% site.deals.each do |deal| %>
          <tr>
            <td><%= deal.id %></td>
            <td><%= deal.listing_date.strftime("%b") %></td>
            <td><%= deal.listing_date %></td>
            <td><%= site.title %></td>
            <td><%= deal.revenue %></td>
          </tr>
        <% end %>
      <% end %>
		</tbody>
	</table>
  <br/>
  <br/>
</div>

<script>
  

  const config = {
    type: 'line',
    data: <%= raw @data.to_json %>,
    options: {}
  };

  const myChart = new Chart(
    document.getElementById('myChart'),
    config
  );

  document.addEventListener('turbolinks:load', function() {
    $('#sites-table').DataTable();
  });
</script>
